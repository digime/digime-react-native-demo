apply plugin: 'com.android.application'

android {
    compileSdkVersion 27
    defaultConfig {
        applicationId "me.digi.androiddemo"
        minSdkVersion 21
        targetSdkVersion 27
        versionCode 1
        versionName "1.0"
        testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"

        def appName = ''
        def appId = ''
        def contractId = ''
        def p12FileName = ''
        def p12PassPhrase = ''

        try {
            def keystorePropertiesFile = file("build.properties")
            def keystoreProperties = new Properties()
            keystoreProperties.load(new FileInputStream(keystorePropertiesFile))

            printf keystoreProperties.toString()

            appName = keystoreProperties['app_name']
            appId = keystoreProperties['app_id']
            contractId = keystoreProperties['contract_id']
            p12FileName = keystoreProperties['p12_keystore_filename']
            p12PassPhrase = keystoreProperties['p12_keystore_passphrase']

        } catch (ex) {
            printf 'Unable to read build.properties file'
        }

        resValue "string", "app_id", appId
        resValue "string", "app_name", appName
        resValue "string", "p12_pass", p12PassPhrase
        resValue "string", "contract_id", contractId
        resValue "string", "p12_filename", p12FileName

        ndk {
            abiFilters "armeabi-v7a", "x86", 'armeabi', 'arm64-v8a'
        }

        packagingOptions {
            // The project react-native does not provide 64-bit binaries at the
            // time of this writing. Unfortunately, packaging any 64-bit
            // binaries into the .apk will crash the app at runtime on 64-bit
            // platforms.
            exclude '/lib/mips64/**'
            exclude '/lib/arm64-v8a/**'
            exclude '/lib/x86_64/**'
        }
    }
    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
}

dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
    implementation 'com.android.support:appcompat-v7:27.1.1'
    implementation 'com.android.support.constraint:constraint-layout:1.1.1'
    testImplementation 'junit:junit:4.12'
    androidTestImplementation 'com.android.support.test:runner:1.0.2'
    androidTestImplementation 'com.android.support.test.espresso:espresso-core:3.0.2'
    implementation "com.facebook.react:react-native:0.55.4" // From node_modules
    implementation 'me.digi.sdk:digime-core:1.3.1'
}
